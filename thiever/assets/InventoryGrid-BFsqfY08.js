import{i as L,b as q,I as w,a as we,_ as he}from"./ItemSearch-CCBr724u.js";import{d as ne,x as le,y as oe,r as v,z as ae,A as se,e as N,c as m,o as u,F as J,b as a,a as y,h as B,g as K,p as ue,u as T,T as ie,B as de,w as re,C as me,n as P,t as X,_ as ve,l as _,k as ee,s as te,D as Ie,E as Ve}from"./index-DBcLFWe9.js";const $e={class:"flex justify-center"},Se={class:"space-y-3 w-fit"},De={class:"equipment-grid"},qe={class:"head"},Te={class:"cape"},Ee={class:"neck"},Me={class:"ammo"},ze={class:"weapon"},Ge={class:"body"},Ae={class:"shield"},Le={class:"legs"},Be={class:"hands"},Oe={class:"feet"},je={class:"slot-ring"},Ne={key:0},Ue={key:1},Fe={class:"flex justify-center gap-2"},Qe=["disabled"],Re={key:0},Je={key:1},Ke=["disabled"],Pe=ne({__name:"EquipmentGrid",props:{modelValue:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(s,{emit:U}){const{isTwoHanded:O}=le(),{getEquipment:F}=oe(),{isDemoMode:E,demoTooltip:I}=de(),g=s,$=U,G=v(!1),k=v(null),f=v(null),C=v(null),h=v({x:0,y:0});function d(i,e){g.disabled||(k.value=i,f.value=e,G.value=!0)}function c(i,e){if(g.disabled)return;const t=g.modelValue[e];L(t)||(i.preventDefault(),C.value=e,h.value={x:i.clientX,y:i.clientY})}function x(){C.value=null}function A(){if(!C.value)return;const i=C.value,e=g.modelValue[i];q(e)?$("update:modelValue",{...g.modelValue,[i]:null}):e===null&&$("update:modelValue",{...g.modelValue,[i]:{ignored:!0}}),x()}function M(i){i.target.closest(".context-menu")||x()}ae(()=>{document.addEventListener("click",M)}),se(()=>{document.removeEventListener("click",M)});function z(i){if(!k.value)return;const e={...g.modelValue,[k.value]:i};k.value==="weapon"&&O(i.osrsId)&&(e.shield=null),k.value==="shield"&&e.weapon&&O(e.weapon.osrsId)&&(e.weapon=null),$("update:modelValue",e)}function p(i){$("update:modelValue",{...g.modelValue,[i]:null})}const V=v(!1),D=v(!1),S=N(()=>Object.values(g.modelValue).some(i=>L(i)||q(i)));function Q(){if(!V.value){V.value=!0,setTimeout(()=>{V.value=!1},3e3);return}$("update:modelValue",{head:null,cape:null,neck:null,ammo:null,weapon:null,body:null,shield:null,legs:null,hands:null,feet:null,ring:null}),V.value=!1}async function R(){if(!(g.disabled||D.value)){D.value=!0;try{const i=await F(),e={head:null,cape:null,neck:null,ammo:null,weapon:null,body:null,shield:null,legs:null,hands:null,feet:null,ring:null};for(const t of i)e[t.slot]={osrsId:t.id,name:t.name,quantity:t.amount};$("update:modelValue",e)}catch(i){console.error("Failed to fetch equipment:",i)}finally{D.value=!1}}}return(i,e)=>(u(),m(J,null,[a("div",$e,[a("div",Se,[a("div",De,[a("div",qe,[y(w,{item:s.modelValue.head,disabled:s.disabled,size:"42px",transparent:"",onClick:e[0]||(e[0]=t=>d("head",t)),onClear:e[1]||(e[1]=t=>p("head")),onContextmenu:e[2]||(e[2]=t=>c(t,"head"))},null,8,["item","disabled"])]),a("div",Te,[y(w,{item:s.modelValue.cape,disabled:s.disabled,size:"42px",transparent:"",onClick:e[3]||(e[3]=t=>d("cape",t)),onClear:e[4]||(e[4]=t=>p("cape")),onContextmenu:e[5]||(e[5]=t=>c(t,"cape"))},null,8,["item","disabled"])]),a("div",Ee,[y(w,{item:s.modelValue.neck,disabled:s.disabled,size:"42px",transparent:"",onClick:e[6]||(e[6]=t=>d("neck",t)),onClear:e[7]||(e[7]=t=>p("neck")),onContextmenu:e[8]||(e[8]=t=>c(t,"neck"))},null,8,["item","disabled"])]),a("div",Me,[y(w,{item:s.modelValue.ammo,disabled:s.disabled,size:"42px",transparent:"",onClick:e[9]||(e[9]=t=>d("ammo",t)),onClear:e[10]||(e[10]=t=>p("ammo")),onContextmenu:e[11]||(e[11]=t=>c(t,"ammo"))},null,8,["item","disabled"])]),a("div",ze,[y(w,{item:s.modelValue.weapon,disabled:s.disabled,size:"42px",transparent:"",onClick:e[12]||(e[12]=t=>d("weapon",t)),onClear:e[13]||(e[13]=t=>p("weapon")),onContextmenu:e[14]||(e[14]=t=>c(t,"weapon"))},null,8,["item","disabled"])]),a("div",Ge,[y(w,{item:s.modelValue.body,disabled:s.disabled,size:"42px",transparent:"",onClick:e[15]||(e[15]=t=>d("body",t)),onClear:e[16]||(e[16]=t=>p("body")),onContextmenu:e[17]||(e[17]=t=>c(t,"body"))},null,8,["item","disabled"])]),a("div",Ae,[y(w,{item:s.modelValue.shield,disabled:s.disabled,size:"42px",transparent:"",onClick:e[18]||(e[18]=t=>d("shield",t)),onClear:e[19]||(e[19]=t=>p("shield")),onContextmenu:e[20]||(e[20]=t=>c(t,"shield"))},null,8,["item","disabled"])]),a("div",Le,[y(w,{item:s.modelValue.legs,disabled:s.disabled,size:"42px",transparent:"",onClick:e[21]||(e[21]=t=>d("legs",t)),onClear:e[22]||(e[22]=t=>p("legs")),onContextmenu:e[23]||(e[23]=t=>c(t,"legs"))},null,8,["item","disabled"])]),a("div",Be,[y(w,{item:s.modelValue.hands,disabled:s.disabled,size:"42px",transparent:"",onClick:e[24]||(e[24]=t=>d("hands",t)),onClear:e[25]||(e[25]=t=>p("hands")),onContextmenu:e[26]||(e[26]=t=>c(t,"hands"))},null,8,["item","disabled"])]),a("div",Oe,[y(w,{item:s.modelValue.feet,disabled:s.disabled,size:"42px",transparent:"",onClick:e[27]||(e[27]=t=>d("feet",t)),onClear:e[28]||(e[28]=t=>p("feet")),onContextmenu:e[29]||(e[29]=t=>c(t,"feet"))},null,8,["item","disabled"])]),a("div",je,[y(w,{item:s.modelValue.ring,disabled:s.disabled,size:"42px",transparent:"",onClick:e[30]||(e[30]=t=>d("ring",t)),onClear:e[31]||(e[31]=t=>p("ring")),onContextmenu:e[32]||(e[32]=t=>c(t,"ring"))},null,8,["item","disabled"])])]),(u(),B(ie,{to:"body"},[C.value!==null?(u(),m("div",{key:0,class:"context-menu fixed z-[9999] bg-neutral-800 border border-neutral-600 rounded-lg shadow-xl p-2 min-w-[140px]",style:ue({top:h.value.y+"px",left:h.value.x+"px"})},[a("button",{type:"button",class:"w-full px-3 py-2 text-left text-sm text-neutral-200 hover:bg-neutral-700 rounded transition-colors flex items-center gap-2",onClick:A},[e[34]||(e[34]=a("svg",{class:"w-4 h-4 text-amber-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})],-1)),T(q)(s.modelValue[C.value])?(u(),m("span",Ne,"Unignore slot")):(u(),m("span",Ue,"Ignore slot"))]),e[35]||(e[35]=a("p",{class:"px-3 py-1 text-xs text-neutral-500"}," Script won't change this slot ",-1))],4)):K("",!0)])),a("div",Fe,[T(E)?(u(),B(me,{key:0,text:T(I),position:"top"},{default:re(()=>[...e[36]||(e[36]=[a("button",{type:"button",class:"px-3 py-1.5 text-xs bg-neutral-700 text-neutral-200 rounded opacity-50 cursor-not-allowed",disabled:""}," Get In-Game ",-1)])]),_:1},8,["text"])):(u(),m("button",{key:1,type:"button",class:"px-3 py-1.5 text-xs bg-neutral-700 hover:bg-neutral-600 text-neutral-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:s.disabled||D.value,onClick:R},[D.value?(u(),m("span",Re,"Loading...")):(u(),m("span",Je,"Get In-Game"))],8,Qe)),a("button",{type:"button",class:P(["px-3 py-1.5 text-xs transition-colors rounded disabled:opacity-50 disabled:cursor-not-allowed",V.value?"bg-red-600 hover:bg-red-500 text-white":"text-neutral-400 hover:text-red-400 hover:bg-neutral-800"]),disabled:s.disabled||!S.value,onClick:Q},X(V.value?"Click to confirm":"Clear All"),11,Ke)])])]),y(we,{show:G.value,"onUpdate:show":e[33]||(e[33]=t=>G.value=t),"anchor-el":f.value,"show-quantity":!1,"equipment-slot":k.value??void 0,onSelect:z},null,8,["show","anchor-el","equipment-slot"])],64))}}),yt=ve(Pe,[["__scopeId","data-v-bdc17f71"]]),Xe={class:"flex gap-3 items-start"},Ye={class:"space-y-3 w-fit"},He={class:"inventory-grid"},We={key:0,class:"flex items-center gap-2"},Ze={key:1,class:"min-w-[140px]"},_e={key:0},et={key:1},tt={class:"flex justify-center gap-2"},nt=["disabled"],lt={key:0},ot={key:1},at=["disabled"],st={class:"flex-1 min-w-[200px] space-y-3"},ut=["disabled"],it={class:"item-list custom-scrollbar"},dt={key:0,class:"px-3 py-8 text-center text-neutral-500 text-sm"},rt={key:1,class:"px-3 py-8 text-center text-neutral-500 text-sm"},mt={key:2,class:"px-3 py-8 text-center text-neutral-500 text-sm"},vt=["onDragstart","onClick"],ct={class:"truncate"},ft=ne({__name:"InventoryGrid",props:{modelValue:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(s,{emit:U}){const{isDemoMode:O,demoTooltip:F}=de(),E=s,I=U,{searchItems:g,loading:$}=le(),{getInventory:G}=oe(),k=v(!1),f=N(()=>{const l=[];for(let n=0;n<28;n++)l.push(E.modelValue[n]??null);return l}),C=v(""),h=v(null),d=v(null),c=v(null),x=v(null),A=v({x:0,y:0}),M=v("item"),z=v(1),p=v(null),V=N(()=>C.value.trim()?g(C.value,50):[]);function D(l){const n=[...f.value];n[l]=null,I("update:modelValue",n)}const S=v(!1);function Q(){if(!S.value){S.value=!0,setTimeout(()=>{S.value=!1},3e3);return}I("update:modelValue",Array(28).fill(null)),S.value=!1}const R=N(()=>f.value.some(l=>L(l)||q(l)));async function i(){if(!(E.disabled||k.value)){k.value=!0;try{const l=await G(),n=Array(28).fill(null);for(const o of l)o.slot>=0&&o.slot<28&&(n[o.slot]={osrsId:o.id,name:o.name,quantity:o.amount});I("update:modelValue",n)}catch(l){console.error("Failed to fetch inventory:",l)}finally{k.value=!1}}}function e(){return f.value.findIndex(l=>l===null)}function t(l,n,o){if(E.disabled)return;let r=o;if(r===void 0&&(r=e(),r===-1))return;const b=f.value[r];if(o===void 0&&q(b))return;const Z=[...f.value];Z[r]={osrsId:l,name:n,quantity:1},I("update:modelValue",Z)}function ce(l,n){if(E.disabled)return;const o=f.value[n];l.preventDefault(),x.value=n,A.value={x:l.clientX,y:l.clientY},L(o)?(M.value="item",z.value=o.quantity,Ve(()=>{var r,b;(r=p.value)==null||r.focus(),(b=p.value)==null||b.select()})):M.value="empty"}function j(){x.value=null}function fe(){if(x.value===null)return;const l=[...f.value],n=l[x.value];q(n)?l[x.value]=null:n===null&&(l[x.value]={ignored:!0}),I("update:modelValue",l),j()}function Y(){if(x.value===null)return;const l=[...f.value],n=l[x.value];L(n)&&(l[x.value]={...n,quantity:Math.max(1,z.value||1)},I("update:modelValue",l)),j()}function pe(l){l.key==="Enter"?Y():l.key==="Escape"&&j()}function H(l){l.target.closest(".context-menu")||j()}ae(()=>{document.addEventListener("click",H)}),se(()=>{document.removeEventListener("click",H)});function xe(l,n){t(l,n)}function be(l,n,o){h.value={osrsId:n,name:o},l.dataTransfer&&(l.dataTransfer.effectAllowed="copy",l.dataTransfer.setData("text/plain",JSON.stringify({osrsId:n,name:o})))}function W(){h.value=null,d.value=null,c.value=null}function ye(l,n){const o=f.value[n];o&&(d.value=n,h.value={osrsId:o.osrsId,name:o.name},l.dataTransfer&&(l.dataTransfer.effectAllowed="move",l.dataTransfer.setData("text/plain",JSON.stringify({index:n,item:o}))))}function ge(l,n){l.preventDefault(),l.dataTransfer&&(l.dataTransfer.dropEffect=d.value!==null?"move":"copy"),c.value=n}function ke(){c.value=null}function Ce(l,n){if(l.preventDefault(),c.value=null,d.value!==null&&d.value!==n){const o=[...f.value],r=o[n];o[n]=o[d.value],o[d.value]=r,I("update:modelValue",o)}else h.value&&d.value===null&&t(h.value.osrsId,h.value.name,n);h.value=null,d.value=null}function pt(l){}return(l,n)=>(u(),m("div",Xe,[a("div",Ye,[a("div",He,[(u(!0),m(J,null,_(f.value,(o,r)=>(u(),B(w,{key:r,item:o,disabled:s.disabled,"show-quantity":!0,draggable:!s.disabled,transparent:"",class:P({"drag-over":c.value===r&&d.value!==r,dragging:d.value===r}),onClick:b=>void 0,onClear:b=>D(r),onDragstart:b=>ye(b,r),onDragend:W,onDragover:b=>ge(b,r),onDragleave:ke,onDrop:b=>Ce(b,r),onContextmenu:b=>ce(b,r)},null,8,["item","disabled","draggable","class","onClick","onClear","onDragstart","onDragover","onDrop","onContextmenu"]))),128))]),(u(),B(ie,{to:"body"},[x.value!==null?(u(),m("div",{key:0,class:"context-menu fixed z-[9999] bg-neutral-800 border border-neutral-600 rounded-lg shadow-xl p-2",style:ue({top:A.value.y+"px",left:A.value.x+"px"})},[M.value==="item"?(u(),m("div",We,[n[3]||(n[3]=a("label",{class:"text-xs text-neutral-400"},"Qty:",-1)),ee(a("input",{ref_key:"quantityInputRef",ref:p,"onUpdate:modelValue":n[0]||(n[0]=o=>z.value=o),type:"number",min:"1",max:"2147483647",class:"w-24 px-2 py-1 bg-neutral-900 border border-neutral-600 rounded text-sm text-neutral-100 focus:outline-none focus:ring-1 focus:ring-orange-500/30 focus:border-orange-500/50",onKeydown:pe,onClick:n[1]||(n[1]=Ie(()=>{},["stop"]))},null,544),[[te,z.value,void 0,{number:!0}]]),a("button",{type:"button",class:"px-2 py-1 text-xs bg-orange-600 hover:bg-orange-500 text-white rounded transition-colors",onClick:Y}," Set ")])):(u(),m("div",Ze,[a("button",{type:"button",class:"w-full px-3 py-2 text-left text-sm text-neutral-200 hover:bg-neutral-700 rounded transition-colors flex items-center gap-2",onClick:fe},[n[4]||(n[4]=a("svg",{class:"w-4 h-4 text-amber-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})],-1)),T(q)(f.value[x.value])?(u(),m("span",_e,"Unignore slot")):(u(),m("span",et,"Ignore slot"))]),n[5]||(n[5]=a("p",{class:"px-3 py-1 text-xs text-neutral-500"}," Script won't change this slot ",-1))]))],4)):K("",!0)])),a("div",tt,[T(O)?(u(),B(me,{key:0,text:T(F),position:"top"},{default:re(()=>[...n[6]||(n[6]=[a("button",{type:"button",class:"px-3 py-1.5 text-xs bg-neutral-700 text-neutral-200 rounded opacity-50 cursor-not-allowed",disabled:""}," Get In-Game ",-1)])]),_:1},8,["text"])):(u(),m("button",{key:1,type:"button",class:"px-3 py-1.5 text-xs bg-neutral-700 hover:bg-neutral-600 text-neutral-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:s.disabled||k.value,onClick:i},[k.value?(u(),m("span",lt,"Loading...")):(u(),m("span",ot,"Get In-Game"))],8,nt)),a("button",{type:"button",class:P(["px-3 py-1.5 text-xs transition-colors rounded disabled:opacity-50 disabled:cursor-not-allowed",S.value?"bg-red-600 hover:bg-red-500 text-white":"text-neutral-400 hover:text-red-400 hover:bg-neutral-800"]),disabled:s.disabled||!R.value,onClick:Q},X(S.value?"Click to confirm":"Clear All"),11,at)])]),a("div",st,[ee(a("input",{"onUpdate:modelValue":n[2]||(n[2]=o=>C.value=o),type:"text",placeholder:"Search items...",class:"w-full px-3 py-2 bg-neutral-800 border border-neutral-700 rounded-md text-sm text-neutral-100 focus:outline-none focus:ring-1 focus:ring-orange-500/30 focus:border-orange-500/50",disabled:s.disabled},null,8,ut),[[te,C.value]]),a("div",it,[T($)?(u(),m("div",dt," Loading items... ")):C.value?V.value.length===0?(u(),m("div",mt," No items found ")):K("",!0):(u(),m("div",rt," Search for items to add ")),(u(!0),m(J,null,_(V.value,o=>(u(),m("div",{key:o.id,class:"item-result",draggable:"true",onDragstart:r=>be(r,o.id,o.name),onDragend:W,onClick:r=>xe(o.id,o.name)},[y(he,{id:o.id,size:"1.5rem"},null,8,["id"]),a("span",ct,X(o.name),1)],40,vt))),128))]),n[7]||(n[7]=a("p",{class:"text-xs text-neutral-500 text-center"}," Click or drag to add. Right-click to set quantity or ignore empty slots. ",-1))])]))}}),gt=ve(ft,[["__scopeId","data-v-ee680253"]]);export{yt as E,gt as I};
